{% extends "layout.html" %}

{% block title %}
    <title>
        历史查询结果
    </title>
{% endblock %}

{% block content %}
    <div style="margin-top: 40px">
        <div id="table-container" class="container">
            <div class="panel panel-default">
                <div class="panel-body">
                    <form method="get">
                        <div class="col-md-3" style="width: 300px">
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1">查询内容搜索</span>
                                <input type="text" name="scontent" class="form-control"
                                       value="{{ filter_condition }}" placeholder="Search for...">
                            </div>
                        </div>
                        <div class="col-md-3" style="width: 300px">
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1">查询类型</span>
                                <select name="stype" class="form-control">
                                    {% for item in type_choices %}
                                        <option value="{{ item.0 }}">{{ item.1 }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary filter-button"
                                type="submit" style="margin-top: 10px;margin-left: 45%">
                            筛 选
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div class="container">
            <div id="table-panel" class="panel panel-default">
                <!-- Default panel contents -->
                <div class="panel-heading" style="font-weight: bold;text-align: center">
                    <span class="glyphicon glyphicon-th-list" aria-hidden="true" style="margin-right: 5px"></span>
                    历史查询
                </div>

                <!-- Table -->
                <div class="scroll-list-table">
                    <table id="history-table" class="table">
                        <thead>
                        <tr>
                            <th class="loose-bold-font" style="text-align: center">ID</th>
                            <th class="loose-bold-font" style="text-align: center">查询类型</th>
                            <th class="loose-bold-font" style="text-align: center">查询内容</th>
                            <th class="loose-bold-font" style="text-align: center">预测标签</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for his in history_data %}
                            <tr>
                                <td style="text-align: center">{{ his.时间戳id }}</td>
                                <td style="text-align: center">{{ his.查询类型 }}</td>
                                <td style="text-align: center">{{ his.查询内容 }}</td>
                                <td style="text-align: center">{{ his.预测标签 }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        {#   分页器   #}
        <div class="container" id="pagination">
            <ul class="pagination">
                {{ page_str }}
            </ul>
        </div>
    </div>

{% endblock %}

{% block js %}
    <script>
        document.getElementById('jump-button').addEventListener('click', function (event) {
            var pageInput = document.querySelector('input[name="page"]');
            if (!pageInput.value.trim()) {
                event.preventDefault();
                alert('请输入页码！');
                return;
            }
            if (parseInt(pageInput.value) > parseInt({{ total_page }})) {
                event.preventDefault();
                alert('页码超出范围！');
                return;
            }
            if (parseInt(pageInput.value) < 1) {
                event.preventDefault();
                alert('页码超出范围！');
                return;
            }
            if (isNaN(parseInt(pageInput.value))) {
                event.preventDefault();
                alert('请输入数字！');
                return;
            }
            if (parseInt(pageInput.value) === parseInt({{ current_page }})) {
                event.preventDefault();
                alert('已是当前页！');
                return;
            }


        });
    </script>
{% endblock %}